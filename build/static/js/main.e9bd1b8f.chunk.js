(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{112:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(24),c=n.n(a),i=(n(112),n(10)),s=n(12),l=n(39),u=n(102),d=n(13),h=n(7),p={toys:[],priceAvg:null};var j=n(35),b=n.n(j),v=b.a.create({withCredentials:!0}),f="/api/auth",O="loggedinUser",y={getLoggedinUser:function(){return JSON.parse(sessionStorage.getItem(O))},login:function(e){return v.post("".concat(f,"/login"),e).then((function(e){return e.data})).then((function(e){return sessionStorage.setItem(O,JSON.stringify(e)),e}))},logout:function(){return v.post("".concat(f,"/logout")).then((function(){return sessionStorage.removeItem(O)}))},signup:function(e){return v.post("".concat(f,"/signup"),e).then((function(e){return e.data})).then((function(e){return sessionStorage.setItem(O,JSON.stringify(e)),e}))}};var g={user:y.getLoggedinUser()};var m={reviews:[]};var x=Object(l.b)({toyModule:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=arguments.length>1?arguments[1]:void 0,o=t;switch(n.type){case"SET_TOYS":o=Object(h.a)(Object(h.a)({},t),{},{toys:n.toys});break;case"REMOVE_TOY":e=t.toys.filter((function(e){return e._id!==n.toyId})),o=Object(h.a)(Object(h.a)({},t),{},{toys:e});break;case"ADD_TOY":o=Object(h.a)(Object(h.a)({},t),{},{toys:[].concat(Object(d.a)(t.toys),[n.toy])});break;case"UPDATE_TOY":e=t.toys.map((function(e){return e._id===n.toy._id?n.toy:e})),o=Object(h.a)(Object(h.a)({},t),{},{toys:e})}return window.toyState=o,o},userModule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,n=e;switch(t.type){case"SET_USER":n=Object(h.a)(Object(h.a)({},e),{},{user:t.user})}return window.userState=n,n},reviewModule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_REVIEWS":return Object(h.a)(Object(h.a)({},e),{},{reviews:t.reviews});case"ADD_REVIEW":return Object(h.a)(Object(h.a)({},e),{},{reviews:[].concat(Object(d.a)(e.reviews),[t.review])});case"REMOVE_REVIEW":return Object(h.a)(Object(h.a)({},e),{},{reviews:e.reviews.filter((function(e){return e._id!==t.reviewId}))});case"UPDATE_REVIEW":return Object(h.a)(Object(h.a)({},e),{},{reviews:e.reviews.map((function(e){return e._id===t.review._id?t.review:e}))});default:return e}}}),w=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.c,S=Object(l.d)(x,w(Object(l.a)(u.a))),C=n(3),k=n(4),E=n(6),T=n(5),A=n(11),I=n(1),N=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(I.jsxs)("div",{className:"home",children:[Object(I.jsx)("h1",{children:"\ud83c\udfb2"}),Object(I.jsx)("h2",{children:"The place for all the toys you will ever want"})]})}}]),n}(r.a.Component),R=n(8),_=n(106),M=b.a.create({withCredentials:!0}),D="/api/toy",U={query:function(e){return M.get(D,{params:e}).then((function(e){return e.data}))},getById:function(e){return M.get("".concat(D,"/").concat(e)).then((function(e){return e.data}))},remove:function(e){return M.delete("".concat(D,"/").concat(e))},add:function(e){return console.log("add",e),M.post(D,e).then((function(e){return e.data}))},update:function(e,t){return M.put("".concat(D,"/").concat(t),e).then((function(n){return console.log("toyservice",e,t),n.data}))}};var B={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},makeLorem:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=["The sky","above","the port","was","the color of television","tuned","to","a dead channel",".","All","this happened","more or less",".","I","had","the story","bit by bit","from various people","and","as generally","happens","in such cases","each time","it","was","a different story",".","It","was","a pleasure","to","burn"],n="";for(;e>0;)e--,n+=t[Math.floor(Math.random()*t.length)]+" ";return n},getRandomIntInclusive:function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},getDate:function(e){var t=new Date(e).getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][new Date(e).getMonth()],o=new Date(e).getDate(),r=new Date(e).getHours();r=r<10?"0".concat(r):r;var a=new Date(e).getMinutes();a=a<10?"0".concat(a):a;var c=0;c=r>=0&&r<12?"".concat(r,":").concat(a," am"):"".concat(r,":").concat(a," pm");return"".concat(n," ").concat(o,", ").concat(t,", ").concat(c)}};var P={on:function(e,t){var n=function(e){var n=e.detail;t(n)};return window.addEventListener(e,n),function(){window.removeEventListener(e,n)}},emit:function(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}};function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";P.emit("show-user-msg",{txt:e,type:t})}function q(e){L(e,"success")}function W(e){L(e,"danger")}function V(e){return function(t){U.query(e).then((function(e){t({type:"SET_TOYS",toys:e}),console.log("toys from DB:",e)}))}}window.myBus=P,window.showUserMsg=L;var F=[{value:"On wheels",label:"On wheels"},{value:"Baby",label:"Baby"},{value:"Doll",label:"Doll"},{value:"Outdoor",label:"Outdoor"},{value:"Battery Powered",label:"Battery Powered"},{value:"Kids",label:"Kids"}],Y=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={newToy:{toyName:"",toyPrice:"",selectedOption:null}},e.clearState=function(){e.setState({clearTemplate:{newToy:{toyName:"",toyPrice:""}}})},e.handleChange=function(t){var n=t.target.name,o=t.target.value;e.setState({newToy:Object(h.a)(Object(h.a)({},e.state.newToy),{},Object(R.a)({},n,o))})},e.handleSelectChange=function(t){e.setState(Object(h.a)(Object(h.a)({},e.state.newToy.selectedOption),{},{selectedOption:t})),console.log("Option selected:",t,e.state)},e.onSave=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&t.preventDefault(),e.props.onAddToy(e.state.newToy),e.clearState()},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state,t=e.toyName,n=e.toyPrice,o=e.selectedOption;return Object(I.jsx)("div",{children:Object(I.jsxs)("form",{onSubmit:this.onSave,children:[Object(I.jsx)("input",{type:"text",name:"toyName",value:t,placeholder:"toyName",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"number",name:"toyPrice",value:n,placeholder:"toyPrice",onChange:this.handleChange,required:!0}),Object(I.jsx)(_.a,{value:o,name:"selectedOption",onChange:this.handleSelectChange,options:F}),Object(I.jsx)("button",{children:"Save"})]})})}}]),n}(r.a.Component);var J={onAddToy:function(e){return function(t){var n={name:e.toyName,price:e.toyPrice,labels:e.selectedOption,createdAt:B.getDate(Date.now()),inStock:!0};console.log("new tou in action",n),U.add(n).then((function(e){console.log("Added toy",e),t({type:"ADD_TOY",toy:e}),q("toy added")})).catch((function(e){W("Cannot add toy")}))}}},G=Object(s.b)((function(e){return{toys:e.toyModule.toys}}),J)(Y),K=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={newToy:{toyName:"",toyPrice:"",inStock:""},toy:null},e.clearState=function(){e.setState({clearTemplate:{newToy:{toyName:"",toyPrice:"",inStock:""}}})},e.handleChange=function(t){var n=t.target.name,o=t.target.value;e.setState({newToy:Object(h.a)(Object(h.a)({},e.state.newToy),{},Object(R.a)({},n,o))})},e.onSave=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&t.preventDefault(),e.props.onEdittoy(e.state.newToy,e.state.toy),e.clearState()},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.toyId;console.log(t);U.getById(t).then((function(t){e.setState({toy:t}),console.log("curr",t)}))}},{key:"render",value:function(){var e=this.state,t=e.toyName,n=e.toyPrice,o=e.inStock;e.toy;return Object(I.jsxs)("div",{children:[Object(I.jsxs)("form",{onSubmit:this.onSave,children:[Object(I.jsx)("input",{type:"text",name:"toyName",value:t,placeholder:"toy name",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"number",name:"toyPrice",value:n,placeholder:"toy price",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"text",name:"inStock",value:o,placeholder:"in Stock? true/false",onChange:this.handleChange,required:!0}),Object(I.jsx)("button",{children:"Edit"})]}),Object(I.jsx)(i.b,{to:"/toy/",children:Object(I.jsx)("button",{children:"Back"})})]})}}]),n}(r.a.Component);var H={onEdittoy:function(e,t){return function(n){var o={_id:t._id,inStock:e.inStock,name:e.toyName,price:e.toyPrice,labels:t.labels,createdAt:t.createdAt};U.update(o,o._id).then((function(e){console.log("Updated toy:",e),n({type:"UPDATE_TOY",savedtoy:e}),q("toy updated")})).catch((function(e){W("Cannot update toy")}))}}},X=Object(s.b)((function(e){return{toys:e.toyModule.toys}}),H)(K),z=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={toy:null},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.toyId;U.getById(t).then((function(t){e.setState({toy:t})}))}},{key:"render",value:function(){var e=this.state.toy;return e?Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:e.name}),Object(I.jsxs)("p",{children:["added at : ",e.createdAt]}),Object(I.jsxs)("p",{children:["price : ",e.price,"$"]}),Object(I.jsxs)("p",{children:["in stock : ",e.inStock?"yes":"no"]}),Object(I.jsx)("p",{children:"labels:"}),e.labels&&Object(I.jsx)("div",{children:e.labels.map((function(e){return Object(I.jsx)("li",{children:e},e)}))})]}):Object(I.jsx)("img",{src:"../img/loading.gif",alt:""})}}]),n}(r.a.Component),Q=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){var e=this,t=this.props.toy;return Object(I.jsxs)("li",{className:"toy-preview margin",children:[Object(I.jsx)("h6",{children:t.name}),Object(I.jsx)(i.b,{to:"/toy/".concat(t._id),children:"more details"}),Object(I.jsxs)("div",{children:[Object(I.jsx)("button",{type:"button",className:"btn btn-outline-danger margin",onClick:function(){e.props.onRemovetoy(t._id)},children:"x"}),Object(I.jsx)(i.b,{className:"link-info margin",to:"/toy/edit/".concat(t._id),children:Object(I.jsx)("button",{type:"button",className:"btn btn-outline-success margin",children:"Edit"})})]})]},t._id)}}]),n}(r.a.Component),Z=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){var e=this,t=this.props.toys;return t?Object(I.jsx)("ul",{className:"toy-list margin",children:t.map((function(t){return Object(I.jsx)(Q,{onRemovetoy:e.props.onRemovetoy,onEdittoy:e.props.onEdittoy,onCheckBox:e.props.onCheckBox,toy:t},t._id)}))}):Object(I.jsx)("img",{src:"../img/loading.gif",alt:""})}}]),n}(r.a.Component);function $(e){var t=e.onChangeFilter;return Object(I.jsxs)("div",{children:[Object(I.jsxs)("select",{className:"browser-default",name:"filter",id:"filter",onChange:function(e){t({inStock:e.target.value})},children:[Object(I.jsx)("option",{value:"all",children:"All"}),Object(I.jsx)("option",{value:"out of stock",children:"Out of stock"}),Object(I.jsx)("option",{value:"in stock",children:"In stock"})]}),Object(I.jsxs)("select",{className:"browser-default",name:"labels",id:"labels",onChange:function(e){t({labels:e.target.value})},children:[Object(I.jsx)("option",{value:"All",children:"All labels"}),Object(I.jsx)("option",{value:"On wheels",children:"On wheels"}),Object(I.jsx)("option",{value:"Baby",children:"Baby"}),Object(I.jsx)("option",{value:"Doll",children:"Doll"}),Object(I.jsx)("option",{value:"Battery Powered",children:"Battery Powered"}),Object(I.jsx)("option",{value:"Kids",children:"Kids"}),Object(I.jsx)("option",{value:"Outdoor",children:"Outdoor"})]}),Object(I.jsx)("input",{onChange:function(e){e.target.field;var n=e.target.value;t({toyName:n})},type:"search",name:"name",id:"name",placeholder:"search"})]})}var ee=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={isAddingToy:!1,sortBy:null},e.onRemovetoy=function(t){e.props.onRemovetoy(t),e.props.loadtoys(e.props.filterBy)},e.onAddToy=function(){e.setState({isAddingToy:!0})},e.onClosAddToy=function(){e.setState({isAddingToy:!1})},e.onChangeFilter=function(t){e.props.loadtoys(t)},e.onChangeSort=function(t){e.setState({sortBy:t})},e.onCheckBox=function(t){e.props.onCheckBox(t)},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){this.props.loadtoys(this.props.filterBy)}},{key:"sortBy",value:function(e,t){return"name"===t?e.sort((function(e,t){return e.name.localeCompare(t.name)})):"price"===t?e.sort((function(e,t){return e.price-t.price})):"created"==t&&e.sort((function(e,t){return e.createdAt-t.createdAt})),e}},{key:"render",value:function(){var e=this,t=this.props.toys;return(t=this.sortBy(t,this.state.sortBy))?Object(I.jsx)("div",{children:Object(I.jsxs)("main",{children:[Object(I.jsx)($,{onChangeFilter:this.onChangeFilter}),Object(I.jsx)("label",{htmlFor:"sort",children:"Sort By:"}),Object(I.jsxs)("select",{className:"browser-default",name:"sort",id:"sort",onChange:function(t){e.onChangeSort(t.target.value)},children:[Object(I.jsx)("option",{value:"name",children:"Name"}),Object(I.jsx)("option",{value:"price",children:"Price"}),Object(I.jsx)("option",{value:"created",children:"Created"})]}),Object(I.jsx)("button",{type:"button",className:"btn-floating btn-large waves-effect waves-light grey",onClick:this.onAddToy,children:Object(I.jsx)("i",{className:"material-icons",children:"add"})}),this.state.isAddingToy&&Object(I.jsxs)("div",{children:[Object(I.jsx)(G,{}),Object(I.jsx)("button",{onClick:this.onClosAddToy,children:"back"})]}),Object(I.jsx)(Z,{onRemovetoy:this.onRemovetoy,onCheckBox:this.onCheckBox,toys:t})]})}):Object(I.jsx)("img",{src:"../img/loading.gif",alt:""})}}]),n}(r.a.Component);var te={loadtoys:V,onRemovetoy:function(e){return function(t){U.remove(e).then((function(){console.log("Deleted Succesfully!"),t({type:"REMOVE_TOY",toyId:e}),q("toy removed")})).catch((function(e){W("Cannot remove toy")}))}},onCheckBox:function(e){}},ne=Object(s.b)((function(e){return{toys:e.toyModule.toys,filterBy:e.toyModule.filterBy}}),te)(ee),oe=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={credentials:{username:"",password:"",fullname:"",prefs:{color:"",bgColor:""}}},e.clearState=function(){e.setState({clearTemplate:{credentials:{username:"",password:"",fullname:"",prefs:{color:"",bgColor:""}}}})},e.handleChange=function(t){var n=t.target.name,o=t.target.value;e.setState({credentials:Object(h.a)(Object(h.a)({},e.state.credentials),{},Object(R.a)({},n,o))})},e.onSave=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&t.preventDefault(),e.props.dispatch({type:"SET_USER",user:e.state.credentials}),e.clearState()},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state.credentials,t=e.username,n=e.password,o=e.fullname,r=e.color,a=e.bgColor;return Object(I.jsx)("div",{children:Object(I.jsx)("div",{children:Object(I.jsxs)("form",{onSubmit:this.onSave,children:[Object(I.jsx)("input",{type:"text",name:"fullname",value:o,placeholder:"Fullname",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"text",name:"username",value:t,placeholder:"Username",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"password",name:"password",value:n,placeholder:"Password",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"color",name:"color",value:r,placeholder:"color",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"color",name:"bgColor",value:a,placeholder:"bgColor",onChange:this.handleChange,required:!0}),Object(I.jsx)("button",{type:"button",className:"btn btn-outline-info",children:"Save"})]})})})}}]),n}(r.a.Component);var re=Object(s.b)((function(e){return{user:e.user}}))(oe),ae=n(107),ce=n(38),ie=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={center:{lat:32.109333,lng:34.855499},isInfoWindowOn:!1},e.onMapClicked=function(t,n,o){console.log("props",t),console.log("map",n),console.log("ev",o),e.setState({center:{lat:o.latLng.lat(),lng:o.latLng.lng()}})},e.onMarkerClicked=function(){e.setState({isInfoWindowOn:!0})},e.onInfoWindowClose=function(){e.setState({isInfoWindowOn:!1})},e}return Object(k.a)(n,[{key:"render",value:function(){return Object(I.jsxs)(ce.Map,{google:this.props.google,zoom:10,initialCenter:this.state.center,onClick:this.onMapClicked,center:this.state.center,style:{width:"85%"},children:[Object(I.jsx)(ce.Marker,{position:this.state.center,name:"Current location",onClick:this.onMarkerClicked}),Object(I.jsx)(ce.InfoWindow,{onClose:this.onInfoWindowClose,position:this.state.center,visible:this.state.isInfoWindowOn,children:Object(I.jsx)("div",{children:Object(I.jsx)("h4",{children:"Rotshild 75,Tel-Aviv-Yaffo"})})})]})}}]),n}(r.a.Component),se=Object(ce.GoogleApiWrapper)({apiKey:"AIzaSyBcHbsl6HTfMsdpKO2d3xY9UYQdF4BIUG4"})(ie),le=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={toysAvgPrice:null},e.setLabelsPercent=function(t){var n=[],o=[];t.map((function(e){e.labels.map((function(t){if(e.labels.includes(t)){n.push(e.price);var r=n.reduce((function(e,t){return e+t}),0)/n.length;o.push(r)}}))})),console.log(o),e.setState({toysAvgPrice:o})},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){this.props.loadtoys(),this.setLabelsPercent(this.props.toys)}},{key:"render",value:function(){var e={labels:["On wheels","Baby","Doll","Battery Powered","Kids","Outdoor"],datasets:[{data:this.state.toysAvgPrice,backgroundColor:["red","rgba(54, 162, 235, 0.2)","grey","yellow","black","pink"],borderColor:["red","rgba(54, 162, 235, 0.2)","grey","yellow","black","pink"],borderWidth:3}]};return Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{children:"Price distribution by type of toy"}),Object(I.jsx)(ae.a,{data:e})]})}}]),n}(r.a.Component);var ue={loadtoys:V},de=Object(s.b)((function(e){return{toys:e.toyModule.toys}}),ue)(le);var he=n(9),pe=n.n(he),je=n(16);var be=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={credentials:{username:"",password:"",fullname:""},isSignup:!1},e.clearState=function(){e.setState({clearTemplate:{credentials:{username:"",password:"",fullname:""},isSignup:!1}})},e.handleChange=function(t){var n=t.target.name,o=t.target.value;e.setState({credentials:Object(h.a)(Object(h.a)({},e.state.credentials),{},Object(R.a)({},n,o))})},e.toggleSignup=function(){e.setState({isSignup:!e.state.isSignup})},e.onLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.state.credentials.username&&e.state.credentials.password&&(t&&t.preventDefault(),e.props.onLogin(e.state.credentials),e.clearState())},e.onSignup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.state.credentials.username&&e.state.credentials.password&&e.state.credentials.fullname&&(t&&t.preventDefault(),e.props.onSignup(e.state.credentials),e.clearState())},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.state.credentials,t=e.username,n=e.password,o=e.fullname,r=this.state.isSignup;return Object(I.jsxs)("div",{className:"login-page",children:[Object(I.jsx)("p",{children:Object(I.jsx)("button",{className:"loginBtn",onClick:this.toggleSignup,children:r?"Login":"Signup"})}),!r&&Object(I.jsxs)("form",{className:"login-form",onSubmit:this.onLogin,children:[Object(I.jsx)("input",{type:"text",name:"username",value:t,placeholder:"Username",onChange:this.handleChange,required:!0,autoFocus:!0}),Object(I.jsx)("input",{type:"password",name:"password",value:n,placeholder:"Password",onChange:this.handleChange,required:!0}),Object(I.jsx)("button",{className:"btn btn-outline-info",children:"Login!"})]}),Object(I.jsx)("div",{className:"signup-section",children:r&&Object(I.jsxs)("form",{className:"signup-form",onSubmit:this.onSignup,children:[Object(I.jsx)("input",{type:"text",name:"fullname",value:o,placeholder:"Fullname",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"text",name:"username",value:t,placeholder:"Username",onChange:this.handleChange,required:!0}),Object(I.jsx)("input",{type:"password",name:"password",value:n,placeholder:"Password",onChange:this.handleChange,required:!0}),Object(I.jsx)("button",{className:"btn btn-outline-info",children:"Signup!"})]})})]})}}]),n}(r.a.Component),ve=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={msg:null},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.removeEvent=P.on("show-user-msg",(function(t){e.setState({msg:t}),setTimeout((function(){e.setState({msg:null})}),2500)}))}},{key:"componentWillUnmount",value:function(){this.removeEvent()}},{key:"render",value:function(){var e=this;if(!this.state.msg)return Object(I.jsx)("span",{});var t=this.state.msg.type||"";return Object(I.jsxs)("section",{className:"user-msg "+t,children:[Object(I.jsx)("button",{onClick:function(){e.setState({msg:null})},children:"x"}),this.state.msg.txt]})}}]),n}(r.a.Component),fe=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).onLogin=function(t){e.props.onLogin(t)},e.onSignup=function(t){e.props.onSignup(t)},e.onLogout=function(){e.props.onLogout()},e}return Object(k.a)(n,[{key:"render",value:function(){var e=this.props.user;return Object(I.jsxs)("header",{children:[Object(I.jsxs)("section",{className:"home bg-info p-2 text-dark bg-opacity-25 margin",children:[e&&Object(I.jsxs)("section",{children:[Object(I.jsx)(i.b,{className:"link-dark margin",to:"/user/".concat(e._id),children:"User profile"}),Object(I.jsxs)("section",{className:"user-info margin ",children:[Object(I.jsxs)("pre",{children:["wellcom back! ",JSON.stringify(e.username)]}),Object(I.jsx)("button",{type:"button",className:" logout btn btn-outline-danger margin",onClick:this.onLogout,children:"Logout"})]})]}),!e&&Object(I.jsx)(be,{onLogin:this.onLogin,onSignup:this.onSignup})]}),Object(I.jsx)(ve,{})]})}}]),n}(r.a.Component);var Oe={onSignup:function(e){return function(t){y.signup(e).then((function(e){t({type:"SET_USER",user:e}),console.log(e)})).catch((function(e){W("Cannot signup"),console.log("Cannot signup",e)}))}},onLogin:function(e){return function(t){y.login(e).then((function(e){return t({type:"SET_USER",user:e})})).catch((function(e){W("Cannot login"),console.log("Cannot login",e)}))}},onLogout:function(){return function(e){y.logout().then((function(){return e({type:"SET_USER",user:null})})).catch((function(e){W("Cannot logout"),console.log("Cannot logout",e)}))}}},ye=Object(s.b)((function(e){return{user:e.userModule.user}}),Oe)(fe),ge="/api/",me=b.a.create({withCredentials:!0}),xe=function(e,t){return Ce(e,"GET",t)},we=function(e,t){return Ce(e,"POST",t)},Se=function(e,t){return Ce(e,"DELETE",t)};function Ce(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(je.a)(pe.a.mark((function e(t){var n,o,r,a=arguments;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"GET",o=a.length>2&&void 0!==a[2]?a[2]:null,e.prev=2,e.next=5,me({url:"".concat(ge).concat(t),method:n,data:o,params:"GET"===n?o:null});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(n,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(o)),console.dir(e.t0),e.t0.response&&401===e.t0.response.status&&window.location.assign("/"),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var Ee={query:Te,get:function(e,t){return Te(e).then((function(e){return e.find((function(e){return e.id===t}))}))},post:function(e,t){return t.id=Ie(),Te(e).then((function(n){return n.push(t),Ae(e,n),t}))},put:function(e,t){return Te(e).then((function(n){var o=n.findIndex((function(e){return e.id===t.id}));return n.splice(o,1,t),Ae(e,n),t}))},remove:function(e,t){return Te(e).then((function(n){var o=n.findIndex((function(e){return e.id===t}));n.splice(o,1),Ae(e,n)}))}};function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1200,n=JSON.parse(localStorage.getItem(e))||U.gToys;return new Promise((function(e,o){setTimeout((function(){e(n)}),t)}))}function Ae(e,t){console.log("entityType FROM SAVE!",e,t),localStorage.setItem(e,JSON.stringify(t))}function Ie(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}var Ne={add:function(e){return Re.apply(this,arguments)},query:function(e){var t=e?"?name=".concat(e.name,"&sort=anaAref"):"";return xe("review".concat(t))},remove:function(e){return Se("review/".concat(e))}};function Re(){return(Re=Object(je.a)(pe.a.mark((function e(t){var n;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we("review",t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(je.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee.query("review");case 2:t=e.sent,window.addEventListener("storage",Object(je.a)(pe.a.mark((function e(){var n;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Storage updated"),e.next=3,Ee.query("review");case 3:(n=e.sent).length===t.length+1&&console.log("Review Added - localStorage updated from another browser"),t=n;case 6:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})))();var _e=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(C.a)(this,n);for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))).state={reviewToEdit:{txt:"",aboutUserId:""}},e.handleChange=function(t){var n=t.target,o=n.name,r=n.value;e.setState((function(e){return{reviewToEdit:Object(h.a)(Object(h.a)({},e.reviewToEdit),{},Object(R.a)({},o,r))}}))},e.addReview=function(){var t=Object(je.a)(pe.a.mark((function t(n){var o;return pe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),(o=e.state.reviewToEdit).txt&&o.aboutUserId){t.next=4;break}return t.abrupt("return",alert("All fields are required"));case 4:return t.next=6,e.props.addReview(e.state.reviewToEdit);case 6:e.setState({reviewToEdit:{txt:"",aboutUserId:""}});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(){var t=Object(je.a)(pe.a.mark((function t(n){return pe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.removeReview(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.canRemove=function(t){var n,o;return t.byUser._id===(null===(n=e.props.loggedInUser)||void 0===n?void 0:n._id)||(null===(o=e.props.loggedInUser)||void 0===o?void 0:o.isAdmin)},e}return Object(k.a)(n,[{key:"componentDidMount",value:function(){this.props.loadReviews(),this.props.loadUsers()}},{key:"render",value:function(){var e=this;return Object(I.jsxs)("div",{className:"home",children:[Object(I.jsx)("h1",{children:"Reviews and Gossip"}),this.props.reviews&&Object(I.jsx)("ul",{className:"review-list",children:this.props.reviews.map((function(t){return Object(I.jsxs)("li",{children:[e.canRemove(t)&&Object(I.jsx)("button",{onClick:function(){return e.onRemove(t._id)},children:"X"}),Object(I.jsxs)("p",{children:["About:",Object(I.jsx)(i.b,{to:"user/".concat(t.aboutUser._id),children:t.aboutUser.fullname})]}),Object(I.jsx)("h3",{children:t.txt}),Object(I.jsxs)("p",{children:["By:",Object(I.jsx)(i.b,{to:"user/".concat(t.byUser._id),children:t.byUser.fullname})]})]},t._id)}))}),this.props.users&&this.props.loggedInUser&&Object(I.jsxs)("form",{onSubmit:this.addReview,children:[Object(I.jsxs)("select",{onChange:this.handleChange,value:this.state.reviewToEdit.aboutUserId,name:"aboutUserId",children:[Object(I.jsx)("option",{value:"",children:"Select User"}),this.props.users.map((function(e){return Object(I.jsx)("option",{value:e._id,children:e.fullname},e._id)}))]}),Object(I.jsx)("textarea",{name:"txt",onChange:this.handleChange,value:this.state.reviewToEdit.txt}),Object(I.jsx)("button",{children:"Submit"})]}),Object(I.jsx)("hr",{})]})}}]),n}(o.Component),Me={loadReviews:function(){return function(){var e=Object(je.a)(pe.a.mark((function e(t){var n;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ne.query();case 3:n=e.sent,t({type:"SET_REVIEWS",reviews:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("ReviewActions: err in loadReviews",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},loadUsers:function(){return function(){var e=Object(je.a)(pe.a.mark((function e(t){var n;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"LOADING_START"}),e.next=4,y.getUsers();case 4:n=e.sent,t({type:"SET_USERS",users:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("UserActions: err in loadUsers",e.t0);case 11:return e.prev=11,t({type:"LOADING_DONE"}),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,8,11,14]])})));return function(t){return e.apply(this,arguments)}}()},addReview:function(e){return function(){var t=Object(je.a)(pe.a.mark((function t(n){var o,r;return pe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ne.add(e);case 3:return o=t.sent,n({type:"ADD_REVIEW",review:o}),t.next=7,y.changeScore(500);case 7:r=t.sent,n({type:"SET_SCORE",score:r}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("ReviewActions: err in addReview",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},removeReview:function(e){return function(){var t=Object(je.a)(pe.a.mark((function t(n){return pe.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ne.remove(e);case 3:n({type:"REMOVE_REVIEW",reviewId:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.log("ReviewActions: err in removeReview",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()}},De=[{path:"/user/:userId",component:re},{path:"/toy/edit/:toyId",component:X},{path:"/toy/dashbord",component:de},,{path:"/toy/login",component:ye},{path:"/toy/:toyId",component:z},{path:"/review",component:Object(s.b)((function(e){return{reviews:e.reviewModule.reviews,users:e.userModule.users,loggedInUser:e.userModule.user}}),Me)(_e),label:"Reviews"},{path:"/toy",component:ne},{path:"/about",component:function(){return Object(I.jsxs)("div",{children:[Object(I.jsx)("h5",{children:"come visit us and see all the selection in our store.."}),Object(I.jsx)(se,{})]})}},{path:"/",component:N}],Ue=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(I.jsxs)("header",{children:[Object(I.jsxs)("nav",{children:[Object(I.jsxs)("div",{className:"nav-wrapper",children:[Object(I.jsx)("a",{href:"/",className:"brand-logo",children:"MisterToys"}),Object(I.jsxs)("ul",{id:"nav-mobile",className:"left hide-on-med-and-down",children:[Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/",children:"Home"})," "]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/about",children:"About"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy",children:"Toys"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy/dashbord",children:"Dashbord"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy/login",children:"Login"})]})," "]})]})," "]}),Object(I.jsx)(ve,{})]})}}]),n}(r.a.Component);var Be=Object(s.b)((function(e){return{user:e.userModule.user,toys:e.toyModule.toys}}))(Ue);function Pe(){return Object(I.jsxs)("footer",{children:[Object(I.jsxs)("nav",{children:[Object(I.jsx)("div",{className:"footer",children:Object(I.jsxs)("ul",{children:[Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/",children:"Home"})," "]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/about",children:"About"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy",children:"Toys"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy/dashbord",children:"Dashbord"})]}),Object(I.jsxs)("li",{children:[" ",Object(I.jsx)(i.c,{to:"/toy/login",children:"Login"})]})," "]})})," "]}),Object(I.jsx)("p",{children:"cofferight 2021 MoriyaEldar"})]})}var Le=function(e){Object(E.a)(n,e);var t=Object(T.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(k.a)(n,[{key:"render",value:function(){return Object(I.jsxs)("div",{children:[Object(I.jsx)(Be,{}),Object(I.jsx)("main",{children:Object(I.jsx)(A.c,{children:De.map((function(e){return Object(I.jsx)(A.a,{exact:!0,component:e.component,path:e.path},e.path)}))})}),Object(I.jsx)(Pe,{})]})}}]),n}(r.a.Component);c.a.render(Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(s.a,{store:S,children:Object(I.jsx)(i.a,{children:Object(I.jsx)(Le,{})})})}),document.getElementById("root"))}},[[268,1,2]]]);
//# sourceMappingURL=main.e9bd1b8f.chunk.js.map